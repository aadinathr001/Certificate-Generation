function generateSlideCertificates() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  const data = sheet.getDataRange().getValues();
  const templateId = 'YOUR_SLIDES_TEMPLATE_ID'; // Replace with your actual template ID

  const folder = DriveApp.createFolder('Generated Certificates');
  const headers = data[0]; // First row: column headers like Name, Date, etc.

  for (let i = 1; i < data.length; i++) {
    const row = data[i];
    const placeholders = {};

    headers.forEach((key, index) => {
      placeholders[`{{${key}}}`] = row[index];
    });

    const name = row[0]; // First column is Name
    const copy = DriveApp.getFileById(templateId).makeCopy(`${name} - Certificate`, folder);
    const presentation = SlidesApp.openById(copy.getId());

    presentation.getSlides().forEach(slide => {
      slide.getShapes().forEach(shape => {
        if (!shape.getText) return;
        const textRange = shape.getText();
        const fullText = textRange.asString();

        let replaced = false;
        let modifiedText = fullText;

        // Replace all placeholders
        Object.keys(placeholders).forEach(placeholder => {
          if (modifiedText.includes(placeholder)) {
            modifiedText = modifiedText.replaceAll(placeholder, placeholders[placeholder]);
            replaced = true;
          }
        });

        if (replaced) {
          textRange.clear();
          const newTextRange = textRange.appendText(modifiedText);

          // Apply default style to all text
          const length = modifiedText.length;
          newTextRange.getRange(0, length - 1).getTextStyle()
            .setFontFamily('Arial')
            .setFontSize(24)
            .setBold(false);

          // Apply special style to the name
          const nameValue = placeholders['{{Name}}'];
          if (nameValue) {
            const nameStart = modifiedText.indexOf(nameValue);
            const nameEnd = nameStart + nameValue.length ;
            if (nameStart >= 0 && nameEnd >= nameStart) {
              newTextRange.getRange(nameStart, nameEnd).getTextStyle()
                .setFontFamily('Baskervville SC')
                .setFontSize(76)
                .setBold(false);
            }
          }
        }
      });
    });

    presentation.saveAndClose();
  }

  SpreadsheetApp.getUi().alert('Certificates with styled names generated!');
}
